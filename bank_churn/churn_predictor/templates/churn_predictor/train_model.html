{% extends 'base.html' %}

{% block title %}üíñ –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ - –ê–Ω–∞–ª–∏–∑ –æ—Ç—Ç–æ–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–∞–Ω–∫–∞{% endblock %}

{% block extra_css %}
<style>
    body {
        background: linear-gradient(to right, #ffe0f0, #f9d1f5);
        font-family: 'Poppins', sans-serif;
    }

    h1, h5 {
        color: #ff1493;
        font-weight: 600;
    }

    .card {
        border: none;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(255, 105, 180, 0.3);
        animation: fadeInUp 1s ease both;
    }

    .card-header {
        background: #fff0f5;
        border-bottom: 2px solid #ff69b4;
        border-top-left-radius: 20px;
        border-top-right-radius: 20px;
    }

    .form-control, .form-select {
        border-radius: 12px;
        border: 1px solid #ff69b4;
    }

    .btn-primary {
        background-color: #ff69b4;
        border: none;
        transition: background-color 0.3s ease;
        font-weight: 500;
    }

    .btn-primary:hover {
        background-color: #ff1493;
    }

    .alert {
        border-radius: 12px;
    }

    .text-success {
        color: #28a745;
    }

    .text-danger {
        color: #dc3545;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translate3d(0, 20px, 0);
        }
        to {
            opacity: 1;
            transform: translate3d(0, 0, 0);
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container py-4">
    <h1 class="mb-4 text-center">‚ú® –û–±—É—á–µ–Ω–∏–µ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ ‚ú®</h1>


    <div class="row g-4">
        <div class="col-md-6">
            <div class="card h-100">
                <div class="card-header">
                    <h5 class="card-title mb-0">üß† –°—Ç–∞—Ç—É—Å –º–æ–¥–µ–ª–∏</h5>
                </div>
                <div class="card-body">
                    <p>
                        <strong>–§–∞–π–ª –º–æ–¥–µ–ª–∏:</strong><br>
                        {% if model_exists %}
                            <span class="text-success">‚úì –°—É—â–µ—Å—Ç–≤—É–µ—Ç</span><br>
                            <small class="text-muted">–ü–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ: {{ last_modified|date:"d.m.Y H:i" }}</small>
                        {% else %}
                            <span class="text-danger">‚úó –ù–µ –Ω–∞–π–¥–µ–Ω</span>
                        {% endif %}
                    </p>
                    <p>
                        <strong>–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è:</strong><br>
                        {% if total_customers > 0 %}
                            <span class="text-success">{{ total_customers }} –∫–ª–∏–µ–Ω—Ç–æ–≤</span>
                        {% else %}
                            <span class="text-danger">–î–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</span>
                        {% endif %}
                    </p>

                    {% if training_results %}
                    <hr>
                    <h6 class="text-muted">üéØ –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:</h6>
                    <ul class="list-unstyled">
                        <li><strong>Epochs:</strong> {{ training_results.training_params.epochs }}</li>
                        <li><strong>Batch Size:</strong> {{ training_results.training_params.batch_size }}</li>
                        <li><strong>Learning Rate:</strong> {{ training_results.training_params.learning_rate }}</li>
                        <li><strong>Validation Split:</strong> {{ training_results.training_params.validation_split }}</li>
                    </ul>
                    <h6 class="text-muted mt-3">üìä –ú–µ—Ç—Ä–∏–∫–∏:</h6>
                    <ul class="list-unstyled">
                        <li><strong>–¢–æ—á–Ω–æ—Å—Ç—å:</strong> {{ training_results.metrics.accuracy|floatformat:4 }}</li>
                        <li><strong>AUC:</strong> {{ training_results.metrics.auc|floatformat:4 }}</li>
                        <li><strong>–ü–æ—Ç–µ—Ä–∏:</strong> {{ training_results.metrics.loss|floatformat:4 }}</li>
                    </ul>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card h-100">
                <div class="card-header">
                    <h5 class="card-title mb-0">üöÄ –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è</h5>
                </div>
                <div class="card-body">
                    <form method="post">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="epochs" class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –æ–±—É—á–µ–Ω–∏—è</label>
                            <input type="number" class="form-control" id="epochs" name="epochs" value="100" min="1" max="1000">
                            <div class="form-text">1‚Äì1000 –∏—Ç–µ—Ä–∞—Ü–∏–π</div>
                        </div>

                        <div class="mb-3">
                            <label for="batch_size" class="form-label">–†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞</label>
                            <select class="form-select" id="batch_size" name="batch_size">
                                <option value="16">16</option>
                                <option value="32" selected>32</option>
                                <option value="64">64</option>
                                <option value="128">128</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label for="learning_rate" class="form-label">–°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è</label>
                            <input type="number" class="form-control" id="learning_rate" name="learning_rate"
                                   value="0.001" step="0.0001" min="0.0001" max="0.1">
                        </div>

                        <div class="mb-3">
                            <label for="validation_split" class="form-label">Validation Split</label>
                            <input type="number" class="form-control" id="validation_split" name="validation_split"
                                   value="0.2" step="0.05" min="0.1" max="0.3">
                        </div>

                        {% if total_customers > 0 %}
                            <button type="submit" class="btn btn-primary w-100">
                                üíæ –ù–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ
                            </button>
                        {% else %}
                            <button type="submit" class="btn btn-primary w-100" disabled>
                                üö´ –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö
                            </button>
                            <div class="alert alert-warning mt-3">
                                –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥ –æ–±—É—á–µ–Ω–∏–µ–º –º–æ–¥–µ–ª–∏.
                            </div>
                        {% endif %}
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}